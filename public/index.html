<!DOCTYPE html>
<html>

<header>
  <h1>WatchTogether Player</h1>
</header>
<div id="player">
  <!--        <iframe width="560" height="315" src="http://www.youtube.com/embed/eMygau1Yy_0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>-->
</div>

<script src="https://www.gstatic.com/firebasejs/5.7.0/firebase.js"></script>
<!--<script src="/__/firebase/7.5.0/firebase-app.js"></script>-->
<!--<script src="/__/firebase/init.js"></script>-->
<script>
<!--  // Initialize Firebase-->
  var config = {
    apiKey: "AIzaSyCfCMSzugyV69uoSyh3LidMRSNvhJ7iHpo",
    authDomain: "watchtogether-555f5.firebaseapp.com",
    databaseURL: "https://watchtogether-555f5.firebaseio.com",
    projectId: "watchtogether-555f5",
    storageBucket: "watchtogether-555f5.appspot.com",
    messagingSenderId: "382915300377",
    appId: "1:382915300377:web:a869162cebcab92e962e88",
    measurementId: "G-7E1KVTNEEV"
  };

  var connections  = 0;

  firebase.initializeApp(config);

    // Get a reference to the database service
    // var database = firebase.database();

  var connectedRef = firebase.database().ref(".info/connected");

  connectedRef.on("value", (snap) => {
    if (snap.val() === true) {
      connections++;
      console.log('Connected: %s connections', connections);
    } else {
      connections--;
      console.log('Disconnected: %s connections', connections);
    }
  });


  var refPlay  = firebase.database().ref().child('Play');
  refPlay.on('value', snap => {
    console.log(snap.val());
    if(snap.val() === 'True') {
        player.playVideo();
    }
  });

  var refPause = firebase.database().ref().child('Pause');
  refPause.on('value', snap => {
    console.log(snap.val());
    if(snap.val() === 'True') {
      player.pauseVideo();
    }
  });

  var refSeekTime = firebase.database().ref().child('SeekTime');
  refSeekTime.on('value', snap => {
    console.log(snap.val());
    var vidTime = player.getCurrentTime();
    if (vidTime < snap.val() - 0.2 || vidTime > snap.val() + 0.2) {
      player.seekTo(snap.val());
      player.playVideo();
    }
  });

</script>
<!-- javascript files -->
<script  src="youtube.js"></script>
</html>


